<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentación - Panel Meteorológico</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { 
            padding: 20px;
            color: #2c3e50;
            line-height: 1.6;
        }
        .section { 
            margin-bottom: 40px;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .function-name {
            color: #2980b9;
            font-weight: bold;
        }
        .error-handling {
            background: #fff5f5;
            border-left: 4px solid #e74c3c;
            padding: 10px 15px;
            margin: 10px 0;
        }
        .note {
            background: #f0f7ff;
            border-left: 4px solid #3498db;
            padding: 10px 15px;
            margin: 10px 0;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container">
        <h1 class="mb-4">Documentación Panel Meteorológico</h1>

        <div class="section">
            <h2>Índice</h2>
            <ul>
                <li><a href="#inicializacion">Inicialización de la Aplicación</a></li>
                <li><a href="#estado">Gestión del Estado</a></li>
                <li><a href="#mapa">Funcionalidad del Mapa</a></li>
                <li><a href="#clima">Gestión del Clima</a></li>
                <li><a href="#grafico">Funcionalidad del Gráfico</a></li>
                <li><a href="#traducciones">Sistema de Traducciones</a></li>
                <li><a href="#errores">Manejo de Errores</a></li>
            </ul>
        </div>

        <div id="inicializacion" class="section">
            <h2>Inicialización de la Aplicación</h2>
            <h4 class="function-name">$(document).ready()</h4>
            <p>Función principal que inicializa la aplicación:</p>
            <ul>
                <li>Configura los tabs de la interfaz</li>
                <li>Inicializa el mapa de Leaflet</li>
                <li>Carga el estado guardado</li>
                <li>Inicializa el sistema de drag & drop</li>
            </ul>
            <div class="note">
                <strong>Nota:</strong> La aplicación utiliza jQuery UI para los tabs y Leaflet para el mapa.
            </div>
        </div>

        <div id="estado" class="section">
            <h2>Gestión del Estado</h2>
            
            <h4 class="function-name">cargarAtributosActivos()</h4>
            <p>Carga los atributos activos desde localStorage o establece los valores por defecto.</p>
            
            <h4 class="function-name">guardarEstado()</h4>
            <p>Guarda en localStorage:</p>
            <ul>
                <li>Atributos activos</li>
                <li>Balizas seleccionadas</li>
                <li>Caché de datos climáticos</li>
            </ul>

            <h4 class="function-name">inicializarEstado()</h4>
            <p>Inicializa el estado de la aplicación:</p>
            <ul>
                <li>Carga atributos activos</li>
                <li>Restaura balizas seleccionadas</li>
                <li>Recupera datos climáticos en caché</li>
            </ul>
            
            <div class="error-handling">
                <strong>Manejo de Errores:</strong>
                <ul>
                    <li>Captura errores durante la inicialización</li>
                    <li>Registra errores en consola</li>
                    <li>Continúa la ejecución incluso si hay errores</li>
                </ul>
            </div>
        </div>

        <div id="mapa" class="section">
            <h2>Funcionalidad del Mapa</h2>
            
            <h4 class="function-name">cargarBalizas(map)</h4>
            <p>Carga y muestra las balizas en el mapa:</p>
            <ul>
                <li>Obtiene datos de balizas del servidor</li>
                <li>Crea marcadores en el mapa</li>
                <li>Configura eventos de interacción</li>
                <li>Gestiona selección/deselección de balizas</li>
            </ul>

            <h4 class="function-name">crearIcono(tipo)</h4>
            <p>Crea iconos personalizados para los marcadores del mapa:</p>
            <ul>
                <li>Azul: baliza no seleccionada</li>
                <li>Rojo: baliza seleccionada</li>
            </ul>

            <div class="error-handling">
                <strong>Manejo de Errores:</strong>
                <ul>
                    <li>Control de errores en la carga de datos</li>
                    <li>Feedback visual del estado de los marcadores</li>
                    <li>Manejo de errores de conexión</li>
                </ul>
            </div>
        </div>

        <div id="clima" class="section">
            <h2>Gestión del Clima</h2>
            
            <h4 class="function-name">actualizarInformacionClimatica()</h4>
            <p>Actualiza y muestra la información climática:</p>
            <ul>
                <li>Obtiene datos climáticos actuales</li>
                <li>Genera cards con información</li>
                <li>Aplica estilos según la temperatura</li>
                <li>Muestra atributos seleccionados</li>
            </ul>

            <h4 class="function-name">obtenerForecast(baliza)</h4>
            <p>Obtiene el pronóstico del tiempo:</p>
            <ul>
                <li>Conecta con la API de Euskalmet</li>
                <li>Procesa y formatea la respuesta</li>
                <li>Maneja caracteres especiales</li>
            </ul>

            <div class="error-handling">
                <strong>Manejo de Errores:</strong>
                <ul>
                    <li>Validación de datos recibidos</li>
                    <li>Mensajes de error personalizados</li>
                    <li>Caché de datos para redundancia</li>
                    <li>Manejo de errores de API</li>
                </ul>
            </div>
        </div>

        <div id="grafico" class="section">
            <h2>Funcionalidad del Gráfico</h2>
            
            <h4 class="function-name">inicializarGraficoChart()</h4>
            <p>Inicializa el gráfico de Chart.js:</p>
            <ul>
                <li>Configura opciones del gráfico</li>
                <li>Establece escalas y ejes</li>
                <li>Define estilos y colores</li>
            </ul>

            <h4 class="function-name">cargarDatosGrafico(balizaId, fechaInicio, fechaFin)</h4>
            <p>Carga y muestra datos históricos:</p>
            <ul>
                <li>Obtiene datos del servidor</li>
                <li>Procesa datos para el gráfico</li>
                <li>Actualiza la visualización</li>
            </ul>

            <div class="error-handling">
                <strong>Manejo de Errores:</strong>
                <ul>
                    <li>Validación de fechas</li>
                    <li>Control de datos vacíos</li>
                    <li>Mensajes de error al usuario</li>
                </ul>
            </div>
        </div>

        <div id="traducciones" class="section">
            <h2>Sistema de Traducciones</h2>
            
            <h4 class="function-name">translatePage()</h4>
            <p>Traduce elementos estáticos de la página</p>

            <h4 class="function-name">updateDynamicTranslations()</h4>
            <p>Actualiza traducciones de elementos dinámicos</p>

            <h4 class="function-name">convertUnit(value, unit)</h4>
            <p>Convierte unidades según el idioma:</p>
            <ul>
                <li>Celsius a Fahrenheit</li>
                <li>Kilómetros a Millas</li>
                <li>Milímetros a Pulgadas</li>
            </ul>

            <div class="note">
                <strong>Nota:</strong> El sistema soporta español (es) e inglés (en), con capacidad de expansión a más idiomas.
            </div>
        </div>

        <div id="errores" class="section">
            <h2>Manejo de Errores</h2>
            
            <h3>Estrategias de Manejo de Errores</h3>
            <ul>
                <li><strong>Caché de Datos:</strong> Reduce dependencia de la red</li>
                <li><strong>Validación de Datos:</strong> Previene errores de procesamiento</li>
                <li><strong>Feedback Visual:</strong> Notifica al usuario sobre errores</li>
                <li><strong>Degradación Elegante:</strong> Mantiene funcionalidad básica en caso de error</li>
            </ul>

            <h3>Tipos de Errores Manejados</h3>
            <ul>
                <li>Errores de Red</li>
                <li>Datos Inválidos</li>
                <li>Errores de API</li>
                <li>Errores de Usuario</li>
            </ul>

            <div class="error-handling">
                <strong>Principales Mensajes de Error:</strong>
                <ul>
                    <li>Error al cargar los datos</li>
                    <li>No hay balizas seleccionadas</li>
                    <li>Error al obtener el pronóstico</li>
                    <li>No se encontraron datos para el período especificado</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 